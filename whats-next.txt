Tasks - Open

Bug
* Click on inspect triggers: java.lang.Error: Invalid case - programming error
** at com.example.settlers.InspectDialogHandler.inspectCallback(BuildDialogHandler.kt:38)

Refactor
* DONE Rename to Township Survival
* DONE Save gamestate in a viewmodel to protect from configuration change
* DONE Use onSaveInstanceState() as backup to handle system-initiated process death https://developer.android.com/topic/libraries/architecture/saving-states#onsaveinstancestate
** DONE This does not work for the whole gamestate, because its to much data.
* Save GameState in Room
* MapManager/ TransportManager does to much stuff
** Try to move some stuff down
*** DONE MapManager
*** TransportManager
* GameState Redesign Ideas:
** Currently it handles sideeffects of other actions.
*** I.E. If a destruction of a building is requested, it deletes all items associated

Infrasturucture
* Save State onConfugurationChange
** ViewModel
* Save State on app Quit
** SaveStateHandle?
** Database?

Graphics
* Add graphics - for in transport items
** Wood
** Lumber
** Stone
** Arrow
* Add ground graphics
* Allow animated graphics.
** If automatic RunLoop is activated, there should be an inbetween step between all steps. In this step, only inbetween graphics are drawn
1 - 0ms
i - 500ms
2 - 1000ms does it look weird, if the animation is changed here?
i - 1500ms
3 - 2000ms
* DONE Add Animation infrastucture
** DONE Add 3 tick Explosion animation
** Make a nice flame/explosion icon
* Bug: Just after starting, the screen flickers, like reloading the app. Whats the issue here?
* Bug: View.generateViewId() creates error message "Invalid ID" in logcat, but seems to work anyway?

Combat
* DONE Tower only requests arrows, if its empty. The requesting can be updated after each shot
* DONE Set a spawner every 200 ticks
** DONE Remove initial spawner
** DONE Tower shoots arrows <--
***DONE Tower should have up to 3 Arrows
*** DONE Request arrows for 'production'
**** DONE Bug: Arrow disappears, after dilivery into tower
*** DONE Add range property
**** DONE Find a Target within range.
**** DONE Every tower searches its surrounding each tick for a valid target
*** DONE The tower will shoot an arrow in a straight line at a zombie within range
**** DONE This is a one tick action, but show an animation at the full shooting path
***** Shooting animation tower
***** red line in the path
***** Get hit animation at zombie
** DONE Add ammunition for towers as new ressource which needs to be in production
*** 1 Dmg, later a dmg property?
*** Progressbar for reload (production)
** DONE Zombies spawner in SE map border. Created with Townhall
** DONE Spawn a Zombie every 100 Ticks (Production)
*** DONE Add Zombie graphics
*** DONE Zombies move 1 tile per tick
**** DONE Zombies ignore Roads and spawners
*** DONE At the moment the old zombies are not deleted in a proper way. so the zombies are blurred over the map
** Buildings have Health
*** DONE 1 At the beginning
*** DONE Zombies explode when they reach a building dealing 1 dmg. So the Building is destroyed
**** DONE Add explosion animation
* Mobs dont attack buildings without resources delivered or in construction or finished

Map

Building
* DONE Add Lumbermill building
** DONE Takes Wood and Produces Lumber
** DONE Jumps production? sometimes when wood is delivered it produces for two ticks
* DONE Disable a building
** DONE This will stop any resources being delivered.
** DONE Works for construction and production
** DONE Color cell Magenta if delivery is stopped
* DONE requiresProduction/requiresConstruction: MutableList<Resource> - Use an immutable list?
* DONE Construction shall consume the items for construction, at the beginning of construction
** DONE Add a fletcher which produces 1 arrow from 1 wood
** DONE Bug: Buildings are not constructing, if the are additional ressources in production.
*** Example is the tower if an arrow is in front of the list
** Add an option to delete a building
* DONE Add Building StoneMason, needs 2 Wood
** DONE Produces stone every 10 Ticks
** DONE Consumes WorldResource Rock
* DONE Monument
** DONE Add Build Pyramids for 100 Wood
* DONE Add Forester
** DONE Production, plants a tree every 10 ticks
*** DONE Add some random where is planted?
*** DONE Trees are planted in the water currently
* DONE Add ShuffledRandomNeighbour to FindWorldResource

Dialog

Production
* Lumberjack
** DONE Only Produces if tree (resource) is in range
** DONE Production will consume a tree
** DONE The production limit is not used, lumberjack produces until full
*** guy moves to the tree and then the production starts? (later)

* DONE Stop production, if 3 produced items are in storage
* DONE Produce does not check if items are requirements are fulfilled
** DONE Requests items for production
*** DONE Add a new step in tick which scans production buildings and sets a request if production storage is empty and no request is pending
*** DONE if building is finished
*** DONE only request stuff for the next production, not two more
** DONE Remove items at the start of production
* Reduce townhall start resources to 2 Wood

TestSetup
** Maybe use of Hilt is better?

Transport
* WONTFIX Currently only the stuff in front of the required queue is requested. I.e. pyramid: lumber+stone are requested. stone is only requested if all lumber is already there. This is hard to do, because touched is only set, after the GameState is applied. This is after the moveResource step.
* Transport is blocked if any field in the path is blocked. It should transport right before the next field
** What happens if the route of an active transport is interrrupted
* Transport priorities are needed
* Ammu < Wood

Routing
* Sometimes buildings request items from a previous transport, then it flickers between two buildings
** Maybe ignore touched here better? Or is it because it gets to a boundary where multiple paths have the same distance?

UI

--------------------------------------------------------------------------------------------------
M1 MVP

* Name - Idea "Township Survival"
* Design MVP which is playable
** Gameloop
*** What are must have buildings
**** (Townhall) Storage
**** (Lumberjack) Material
**** (Defensetower) Shoot zombies
**** (Fletcher) Produces ammo
***
** Goal
*** Build Monument
** Obstacles
*** Enemy spawners
**** Send waves
** Pixelart Graphics
** Scrollable map
*** Run on small phones to see if the scrollable map works
*** ALternative is some grid system, which expands to a single cell on a bigger grid

M2 Playstore
* Make App Icon
* Write Description Text
* Configure Setting
* Launch

M3 Add features